<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<div th:fragment="categories-section">
    <!-- Only render when activeSection == 'categories' -->
    <div class="section-container" id="category-section" th:if="${activeSection == 'categories'}">
        <h3><i class="fas fa-tags me-2"></i>Manage Categories</h3>

        <!-- Success message -->
        <div th:if="${msg}" class="alert alert-success alert-dismissible fade show" role="alert">
            <i class="fas fa-check-circle me-2"></i>
            <span th:text="${msg}"></span>
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
        
        <!-- Error message for duplicate category -->
        <div th:if="${errorMsg}" class="alert alert-danger alert-dismissible fade show" role="alert">
            <i class="fas fa-exclamation-triangle me-2"></i>
            <span th:text="${errorMsg}"></span>
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>

        <!-- Form -->
        <form th:action="@{/admin/category/save}" method="post" class="mb-4">
            <input type="hidden" name="id" th:value="${category != null ? category.id : 0}">
            <div class="row g-2 align-items-end">
                <div class="col-md-6">
                    <label class="form-label">Category Name</label>
                    <input type="text" class="form-control"
                           name="catName" th:value="${category != null ? category.catName : ''}"
                           placeholder="Enter Category Name" required>
                </div>
                <div class="col-md-3">
                    <button type="submit" class="btn btn-primary w-100">
                        <i class="fas fa-save me-1"></i> Save Category
                    </button>
                </div>
            </div>
        </form>

        <!-- Categories Table -->
        <div class="table-responsive">
            <table class="table table-bordered table-hover">
                <thead class="table-dark">
                    <tr>
                        <th style="width: 80px; text-align: center;">No.</th>
                        <th>Category Name</th>
                        <th style="width: 250px; text-align: center;">Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <tr th:each="cat, stat : ${categories}">
                        <td th:text="${stat.count}" style="text-align: center;"></td>
                        <td th:text="${cat.catName}"></td>
                        <td>
                            <div class="d-flex gap-2 justify-content-center">
                                <a th:href="@{'/admin/category/edit/' + ${cat.id}}" 
                                   class="btn btn-sm btn-warning px-3">
                                    <i class="fas fa-edit me-1"></i> Edit
                                </a>
                                <a th:href="@{'/admin/category/delete/' + ${cat.id}}" 
                                   class="btn btn-sm btn-danger px-3"
                                   onclick="return confirm('Are you sure you want to delete this category?')">
                                    <i class="fas fa-trash me-1"></i> Delete
                                </a>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>
</html>
